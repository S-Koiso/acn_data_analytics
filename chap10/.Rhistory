data.dist <- dist(data.scale, method = "euclidean")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2: install dataset and scaling
data.orig <- read.csv("http://enterprisezine.jp/static/images/article/6873/flat35_research_2013.csv", header=TRUE, row.names="都道府県", fileEncoding="UTF-8")
head(data.orig)
# scaling to make the average as 0 and std as 1
data.scale <- scale(data.orig)
data.dist <- dist(data.scale, method = "euclidean")
data.dist
data.dist <- dist(data.scale, method = "euclidean")
?hclust
plot(ward.hclust, hang=-1)
# clustering
ward.hclust <- hclust(data.dist, method = "ward.D2")
plot(ward.hclust, hang=-1)
plot(ward.hclust)
plot(ward.hclust, hang = -1)
# flip the dendrogram 90 degree
plot(as.dendrogram(ward.hclust), horiz = T, main = "Hierarchical Clustering Dendrogram (Ward)")
heatmap(data.scale, Rowv = as.dendrogram(ward.hclust), Colv = NA, scale = "none", main = "Heat Map for Hierarcical Clustering (Ward)")
?heatmap
#category by # of cluster
ward.cutree <- cutree(ward.hclust, k=2:4)
ward.cutree
plot(ward.hclust, hang = -1)
rect.hclust(ward.hclust, k=3, border = "red")
